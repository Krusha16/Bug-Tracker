@model BugTracker.Models.Ticket

@{
    ViewBag.Title = "Details";
}

<h2>Details</h2>

<div>
    <h4>Ticket</h4>
    <hr />
    <dl class="dl-horizontal">
        <dt>
            @Html.DisplayName("Assigned Developer")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.AssignedToUser.Email)
        </dd>

        <dt>
            @Html.DisplayName("Ticket Owner")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.OwnerUser.Email)
        </dd>

        <dt>
            @Html.DisplayName("Project Name")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Project.Name)
        </dd>

        <dt>
            @Html.DisplayName("Priority")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.TicketPriority.Name)
        </dd>

        <dt>
            @Html.DisplayName("Status")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.TicketStatus.Name)
        </dd>

        <dt>
            @Html.DisplayName("Type")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.TicketType.Name)
        </dd>

        <dt>
            @Html.DisplayName("Title")
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Title)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Created)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Created)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Updated)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Updated)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.TicketHistories)
        </dt>

        <dd>
            <table class="table">
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().Ticket.Title)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().User.Email)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().Property)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().OldValue)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().NewValue)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.TicketHistories.First().Changed)
                    </th>
                </tr>

                @foreach (var item in Model.TicketHistories)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Ticket.Title)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.User.Email)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Property)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.OldValue)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.NewValue)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Changed)
                        </td>
                    </tr>
                }
            </table>
        </dd>

        <dt>
            @Html.DisplayName("Comments")
        </dt>

        <dd>
            @foreach (var comment in Model.TicketComments)
            {
                <div class="">
                    <p>@comment.Comment, Date:@comment.Created.ToString("d")</p>
                </div>
            }
        </dd>

        <dt>
            @Html.DisplayName("Attachments")
        </dt>

        <dd>
            @foreach (var attachment in Model.TicketAttachments)
            {
                <p>Description: @attachment.Description</p>
                <p>Added By: @attachment.User.Email</p>
                <a href="@Url.Action("EditAttachment", "Attachments", new { id = attachment.Id })">Edit Attachment</a>
                <a href="@Url.Action("DeleteAttachment", "Attachments", new { id = attachment.Id })">Delete Attachment</a>
            }
        </dd>
    </dl>
</div>
<div class="creat">
    <button class="submitButton" type="button">
        <p class="link">
            @Html.ActionLink("Edit", "Edit", new { id = Model.Id }, new { style = "color: white;text-decoration:none" })
        </p>
    </button>
    <button class="submitButton" type="button">
        <p class="link">
            @Html.ActionLink("Back to List", "Index", null, new { style = "color: white;text-decoration:none" })
        </p>
    </button>
</div>
